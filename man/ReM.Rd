% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/design.R
\name{ReM}
\alias{ReM}
\title{Rerandomization Design Function}
\usage{
ReM(X, n_1, p_a = 0.1, a = NULL, max_tries = 10000, seed = NULL)
}
\arguments{
\item{X}{Numerical matrix; covariate matrix with n rows (units) and K columns (covariates). n >= 2 and K >= 1.}

\item{n_1}{Integer scalar; number of units to assign to treatment. n_1 > 0 and n_1 < nrow(X).}

\item{p_a}{Numeric scalar; acceptance probability in (0, 1], default is 0.1.}

\item{a}{Numeric scalar; Mahalanobis distan. If NULL, it is computed from p_a. Default is NULL. If provided, p_a is ignored.}

\item{max_tries}{Integer scalar; maximum number of random draws before giving up, default is 10000.}

\item{seed}{Integer scalar; optional random seed for reproducibility, default is NULL.}
}
\value{
A list containing:
\describe{
\item{Z}{Numeric vector; accepted treatment assignment with length n and values 0 (control) or 1 (treatment).}
\item{tries}{Integer scalar; number of random draws made until acceptance.}
\item{M}{Numeric scalar; Mahalanobis distance of the accepted assignment.}
\item{a}{Numeric scalar; threshold Mahalanobis distance used for acceptance.}
\item{p_a}{Numeric scalar; acceptance probability used.}
}
}
\description{
This function implements a rerandomization design based on Mahalanobis distance.
}
\examples{
#' set.seed(123)
X <- matrix(rnorm(100 * 3), nrow = 100, ncol = 3)  # 100 units, 3 covariates
result <- ReM(X, n_1 = 50, p_a = 0.1, max_tries = 10000)

}
